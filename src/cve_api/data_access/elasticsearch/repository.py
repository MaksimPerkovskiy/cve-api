from elasticsearch import Elasticsearch
from presentation.api.controllers.requests import SearchRequestModel


class ElasticRepository:
    def __init__(self, client: Elasticsearch) -> None:
        self._client = client
    
    def get_connection_info(self):
        return self._client.info()
    
    def search_cves(self, data: SearchRequestModel):
        res = self._client.search(index='cves', query={'match_all': {}})
        print(res)
